
#if !defined LINALG_DOT_HPP
#define LINALG_DOT_HPP

//#include <pmmintrin.h>
#include <memory.hpp>

using namespace std;


namespace ma {

namespace linalg {

    template<class T>
    void fill(T* v, int size, T val) {
        for (int i = 0; i < size; ++i) {
            v[i] = val;
        }
    }

    template <class T>
    memory::ptr_vec<T> zeros(int size) {
        memory::ptr_vec<T> tmp(new T[size]);
        fill(tmp.get(), size, (T)0);
        return tmp;
    }


    template<class T>
    void copy(T* v1, const T* v2, int size) {
        for (int i = 0; i < size; ++i) {
            v1[i] = v2[i];
        }
    }


    // scalar sum of all elements of the vector v
    // Semantic: sum(v)
    template<class T>
    T sum(const T* v, int size) {
        T accum = 0.;
        for (int i = 0; i < size; ++i)
            accum += v[i];
        return accum;
    }

    // Elementwise sum of 2 vectors
    // the result goes to v1
    // Semantic: v1 += v2
    template<class T>
    void sum_v2v(T* v1, const T* v2, int size) {
        for (int i = 0; i < size; ++i) {
            v1[i] += v2[i];
        }
    }

    template<class T>
    void sub_v2v(const T* v1, const T* v2, T* result, int size) {
        for (int i = 0; i < size; ++i) {
            result[i] = v1[i] - v2[i];
        }
    }

    template<class T>
    void mul_v2v(T* v1, const T* v2, int size) {
        for (int i = 0; i < size; ++i) {
            v1[i] *= v2[i];
        }
    }


    template<class T>
    void mul_add_v2v(const T* v1, const T* v2, T* result, int size) {
        int size_4 = size / 4;
        for (int i = 0; i < size_4; ++i) {
            result[i*4 + 0] += v1[i*4 + 0] * v2[i*4 + 1];
            result[i*4 + 1] += v1[i*4 + 1] * v2[i*4 + 1];
            result[i*4 + 2] += v1[i*4 + 2] * v2[i*4 + 2];
            result[i*4 + 3] += v1[i*4 + 3] * v2[i*4 + 3];
        }
        for (int i = size_4 * 4; i < size; ++i) {
            result[i] += v1[i] * v2[i];
        }
    }

    template<class T>
    void mul_add_v2s(const T* v1, T s, T* result, int size) {
        int size_4 = size / 4;
        for (int i = 0; i < size_4; ++i) {
            result[i*4 + 0] += v1[i*4 + 0] * s;
            result[i*4 + 1] += v1[i*4 + 1] * s;
            result[i*4 + 2] += v1[i*4 + 2] * s;
            result[i*4 + 3] += v1[i*4 + 3] * s;
        }
        for (int i = size_4 * 4; i < size; ++i) {
            result[i] += v1[i] * s;
        }
    }


    template<class T>
    void mul_sub_v2s_use_deltas(const T* v1, T s, T* result, T* deltas, int size) {
        T gamma = .14;
        int size_4 = size / 4;
        for (int i = 0; i < size_4; ++i) {
            deltas[i*4+0] = deltas[i*4+0] * ((v1[i*4 + 0] < 0) == (deltas[i*4+0] < 0));
            deltas[i*4+1] = deltas[i*4+1] * ((v1[i*4 + 1] < 0) == (deltas[i*4+1] < 0));
            deltas[i*4+2] = deltas[i*4+2] * ((v1[i*4 + 2] < 0) == (deltas[i*4+2] < 0));
            deltas[i*4+3] = deltas[i*4+3] * ((v1[i*4 + 3] < 0) == (deltas[i*4+3] < 0));

            T d1 = v1[i*4 + 0] * s + gamma * deltas[i*4+0];
            T d2 = v1[i*4 + 1] * s + gamma * deltas[i*4+1];
            T d3 = v1[i*4 + 2] * s + gamma * deltas[i*4+2];
            T d4 = v1[i*4 + 3] * s + gamma * deltas[i*4+3];

            result[i*4 + 0] -= d1;
            result[i*4 + 1] -= d2;
            result[i*4 + 2] -= d3;
            result[i*4 + 3] -= d4;

            deltas[i*4+0] = d1;
            deltas[i*4+1] = d2;
            deltas[i*4+2] = d3;
            deltas[i*4+3] = d4;
        }
        for (int i = size_4 * 4; i < size; ++i) {
            T d = v1[i] * s + gamma * deltas[i];
            result[i] -= d;
            deltas[i] = d;
        }
    }


    template<class T>
    void div_v2s(T* v, int size, T val) {
        for (int i = 0; i < size; ++i) {
            v[i] /= val;
        }
    }



    // Dot product of 2 vectors
    // Ssemantic: v1 . v2

    template<class T>
    T dot_v2v(const T* v1, const T* v2, int size) {
        T result = (T)0;

        for (int i = 0; i < size; ++i) {
            result += v1[i] * v2[i];
        }

        return result;
    }

    // Dot product of matrix and vector
    // Semantic: m . v
    template<class T>
    void dot_m2v(const T* m, const T* v, T* result, int rows, int columns) {
        for (int r = 0; r < rows; ++r) {
            result[r] = dot_v2v(v, &m[r * columns], columns);
        }
    }

    // Dot product of matrix and vector
    // Semantic: m . v
    template<class T>
    void dot_v2m(const T* v, const T* m, T* result, int rows, int columns) {
        for (int c = 0; c < columns; ++c) {
            result[c] = 0;
            for (int r = 0; r < rows; ++r) {
                result[c] += v[r] * m[r * columns + c];
            }
        }
    }


    template<class T>
    void transpose(const T* m, T* result, int rows, int cols) {
        for (int r = 0; r < rows; ++r) {
            for (int c = 0; c < cols; ++c) {
                result[c*rows + r] = m[r*cols + c];
            }
        }
    }


    template<class T>
    T quick_sigmoid(T v) {
        static const int size = 1000;
        static const T sig_tab[] = { 0.0000453978687024,  0.0000463158512013,  0.0000472523951893,  0.0000482078759416,  0.0000491826763191,  0.0000501771869218,  0.0000511918062453,  0.0000522269408402,  0.0000532830054746,  0.0000543604233008,  0.0000554596260241,  0.0000565810540758,  0.0000577251567895,  0.0000588923925809,  0.0000600832291317,  0.0000612981435760,  0.0000625376226919,  0.0000638021630963,  0.0000650922714431,  0.0000664084646267,  0.0000677512699883,  0.0000691212255274,  0.0000705188801166,  0.0000719447937216,  0.0000733995376250,  0.0000748836946551,  0.0000763978594192,  0.0000779426385411,  0.0000795186509041,  0.0000811265278984,  0.0000827669136742,  0.0000844404653986,  0.0000861478535191,  0.0000878897620315,  0.0000896668887535,  0.0000914799456042,  0.0000933296588882,  0.0000952167695864,  0.0000971420336525,  0.0000991062223152,  0.0001011101223864,  0.0001031545365759,  0.0001052402838128,  0.0001073681995721,  0.0001095391362097,  0.0001117539633023,  0.0001140135679955,  0.0001163188553586,  0.0001186707487457,  0.0001210701901655,  0.0001235181406574,  0.0001260155806758,  0.0001285635104817,  0.0001311629505424,  0.0001338149419398,  0.0001365205467856,  0.0001392808486463,
                                     0.0001420969529756,  0.0001449699875566,  0.0001479011029517,  0.0001508914729624,  0.0001539422950984,  0.0001570547910554,  0.0001602302072032,  0.0001634698150836,  0.0001667749119177,  0.0001701468211242,  0.0001735868928474,  0.0001770965044965,  0.0001806770612951,  0.0001843299968424,  0.0001880567736850,  0.0001918588839008,  0.0001957378496942,  0.0001996952240036,  0.0002037325911207,  0.0002078515673229,  0.0002120538015174,  0.0002163409758995,  0.0002207148066230,  0.0002251770444847,  0.0002297294756222,  0.0002343739222265,  0.0002391122432679,  0.0002439463352372,  0.0002488781329014,  0.0002539096100746,  0.0002590427804049,  0.0002642796981761,  0.0002696224591261,  0.0002750732012820,  0.0002806341058112,  0.0002863073978901,  0.0002920953475900,  0.0002980002707805,  0.0003040245300520,  0.0003101705356551,  0.0003164407464603,  0.0003228376709360,  0.0003293638681465,  0.0003360219487698,  0.0003428145761358,  0.0003497444672851,  0.0003568143940494,  0.0003640271841534,  0.0003713857223380,  0.0003788929515072,  0.0003865518738967,  0.0003943655522670,  0.0004023371111189,  0.0004104697379350,  0.0004187666844444,  0.0004272312679137,  0.0004358668724631,
                                     0.0004446769504095,  0.0004536650236353,  0.0004628346849854,  0.0004721895996918,  0.0004817335068265,  0.0004914702207833,  0.0005014036327890,
                                     0.0005115377124451,  0.0005218765092998,  0.0005324241544516,  0.0005431848621839,  0.0005541629316337,  0.0005653627484918,  0.0005767887867379,  0.0005884456104093,  0.0006003378754057,  0.0006124703313289,  0.0006248478233594,  0.0006374752941703,  0.0006503577858787,  0.0006635004420363,  0.0006769085096590,  0.0006905873412968,  0.0007045423971448,  0.0007187792471957,  0.0007333035734348,  0.0007481211720790,  0.0007632379558588,  0.0007786599563469,  0.0007943933263310,  0.0008104443422352,  0.0008268194065874,  0.0008435250505364,  0.0008605679364186,  0.0008779548603740,  0.0008956927550153,  0.0009137886921482,  0.0009322498855455,  0.0009510836937758,  0.0009702976230877,  0.0009898993303500,  0.0010098966260505,  0.0010302974773524,  0.0010511100112111,  0.0010723425175520,  0.0010940034525102,  0.0011161014417332,  0.0011386452837486,  0.0011616439533969,  0.0011851066053317,  0.0012090425775871,  0.0012334613952160,  0.0012583727739972,  0.0012837866242162,  0.0013097130545182,  0.0013361623758362,  0.0013631451053954,  0.0013906719707944,  0.0014187539141658,  0.0014474020964172,  0.0014766279015534,  0.0015064429410829,  0.0015368590585080,  0.0015678883339021,
                                     0.0015995430885749,  0.0016318358898268,  0.0016647795557943,  0.0016983871603889,  0.0017326720383296,  0.0017676477902719,  0.0018033282880350,  0.0018397276799277,  0.0018768603961766,  0.0019147411544569,  0.0019533849655283,  0.0019928071389777,  0.0020330232890705,  0.0020740493407129,  0.0021159015355262,  0.0021585964380354,  0.0022021509419755,  0.0022465822767145,  0.0022919080137981,  0.0023381460736164,  0.0023853147321956,  0.0024334326281160,  0.0024825187695591,  0.0025325925414858,  0.0025836737129473,  0.0026357824445326,  0.0026889392959522,  0.0027431652337628,  0.0027984816392338,  0.0028549103163587,  0.0029124735000126,  0.0029711938642600,  0.0030310945308136,  0.0030921990776473,  0.0031545315477658,  0.0032181164581329,  0.0032829788087616,  0.0033491440919680,  0.0034166383017918,  0.0034854879435852,  0.0035557200437743,  0.0036273621597943,  0.0037004423902008,  0.0037749893849617,  0.0038510323559303,  0.0039286010875028,  0.0040077259474643,  0.0040884378980233,  0.0041707685070400,  0.0042547499594494,  0.0043404150688825,  0.0044277972894884,  0.0045169307279598,  0.0046078501557647,  0.0047005910215866,  0.0047951894639770,  0.0048916823242216,
                                     0.0049901071594235,  0.0050905022558065,  0.0051929066422402,  0.0052973601039908,  0.0054039031966987,  0.0055125772605872,  0.0056234244349034,
                                     0.0057364876725952,  0.0058518107552258,  0.0059694383081293,  0.0060894158158087,  0.0062117896375798,  0.0063366070234627,  0.0064639161303240,  0.0065937660382709,  0.0067262067673001,  0.0068612892942043,  0.0069990655697370,  0.0071395885360387,  0.0072829121443256,  0.0074290913728443,  0.0075781822450920,  0.0077302418483054,  0.0078853283522199,  0.0080435010280999,  0.0082048202680413,  0.0083693476045490,  0.0085371457303885,  0.0087082785187140,  0.0088828110434733,  0.0090608096000892,  0.0092423417264202,  0.0094274762239984,  0.0096162831795456,  0.0098088339867683,  0.0100052013684297,  0.0102054593986994,  0.0104096835257801,  0.0106179505948090,  0.0108303388710339,  0.0110469280632626,  0.0112677993475822,  0.0114930353913483,  0.0117227203774398,  0.0119569400287781,  0.0121957816331065,  0.0124393340680269,  0.0126876878262899,  0.0129409350413341,  0.0131991695130699,  0.0134624867339031,  0.0137309839149921,  0.0140047600127338,  0.0142839157554710,  0.0145685536704141,  0.0148587781107715,  0.0151546952830778,  0.0154564132747139,  0.0157640420816086,  0.0160776936361118,  0.0163974818350296,  0.0167235225678096,  0.0170559337448655,  0.0173948353260273,
                                     0.0177403493491048,  0.0180925999585510,  0.0184517134342083,  0.0188178182201255,  0.0191910449534253,  0.0195715264932081,  0.0199593979494719,  0.0203547967120306,  0.0207578624794088,  0.0211687372876936,  0.0215875655393204,  0.0220144940317694,  0.0224496719861486,  0.0228932510756375,  0.0233453854537653,  0.0238062317824948,  0.0242759492600842,  0.0247546996486943,  0.0252426473017113,  0.0257399591907510,  0.0262468049323094,  0.0267633568140253,  0.0272897898205154,  0.0278262816587445,  0.0283730127828893,  0.0289301664186543,  0.0294979285869952,  0.0300764881272053,  0.0306660367193170,  0.0312667689057704,  0.0318788821122967,  0.0325025766679660,  0.0331380558243435,  0.0337855257736992,  0.0344451956662112,  0.0351172776261050,  0.0358019867666643,  0.0364995412040511,  0.0372101620698677,  0.0379340735223931,  0.0386715027564239,  0.0394226800116464,  0.0401878385794660,  0.0409672148082172,  0.0417610481066759,  0.0425695809457920,  0.0433930588585600,  0.0442317304379422,  0.0450858473327563,  0.0459556642414397,  0.0468414389035954,  0.0477434320892291,  0.0486619075855790,  0.0495971321814405,  0.0505493756488864,  0.0515189107222791,  0.0525060130744714,
                                     0.0535109612900885,  0.0545340368357838,  0.0555755240273587,  0.0566357099936330,  0.0577148846369538,  0.0588133405902278,  0.0599313731703591,
                                     0.0610692803279753,  0.0622273625933226,  0.0634059230182089,  0.0646052671138742,  0.0658257027846642,  0.0670675402573862,  0.0683310920062214,  0.0696166726730714,  0.0709245989832134,  0.0722551896561402,  0.0736087653114617,  0.0749856483697434,  0.0763861629481603,  0.0778106347508436,  0.0792593909538007,  0.0807327600842886,  0.0822310718945255,  0.0837546572296239,  0.0853038478896344,  0.0868789764855916,  0.0884803762894543,  0.0901083810778390,  0.0917633249694496,  0.0934455422561073,  0.0951553672272940,  0.0968931339881253,  0.0986591762706753,  0.1004538272385834,  0.1022774192848769,  0.1041302838229548,  0.1060127510706816,  0.1079251498275528,  0.1098678072448977,  0.1118410485891006,  0.1138451969978251,  0.1158805732292426,  0.1179474954042733,  0.1200462787418619,  0.1221772352873221,  0.1243406736337968,  0.1265368986368946,  0.1287662111225774,  0.1310289075883892,  0.1333252798981306,  0.1356556149701001,  0.1380201944590403,  0.1404192944319427,  0.1428531850378841,  0.1453221301720851,  0.1478263871343993,  0.1503662062824616,  0.1529418306797442,  0.1555534957387875,  0.1582014288598950,  0.1608858490655999,  0.1636069666312365,  0.1663649827119655,
                                     0.1691600889666274,  0.1719924671788200,  0.1748622888756160,  0.1777697149443603,  0.1807148952480076,  0.1836979682394838,  0.1867190605755757,  0.1897782867308753,  0.1928757486123260,  0.1960115351749403,  0.1991857220392764,  0.2023983711112847,  0.2056495302051508,  0.2089392326697834,  0.2122674970196105,  0.2156343265703678,  0.2190397090805745,  0.2224836163994119,  0.2259660041217288,  0.2294868112509137,  0.2330459598703838,  0.2366433548244495,  0.2402788834093215,  0.2439524150750357,  0.2476638011390717,  0.2514128745124481,  0.2551994494390749,  0.2590233212491425,  0.2628842661273275,  0.2667820408965821,  0.2707163828182745,  0.2746870094094315,  0.2786936182778247,  0.2827358869756263,  0.2868134728723437,  0.2909260130477195,  0.2950731242052657,  0.2992544026070717,  0.3034694240304996,  0.3077177437473528,  0.3119988965260661,  0.3163123966574362,  0.3206577380043702,  0.3250343940760905,  0.3294418181271946,  0.3338794432819204,  0.3383466826839235,  0.3428429296718246,  0.3473675579807307,  0.3519199219698881,  0.3564993568765628,  0.3611051790961964,  0.3657366864888217,  0.3703931587116688,  0.3750738575778298,  0.3797780274407924,  0.3845048956045907,
                                     0.3892536727592594,  0.3940235534412184,  0.3988137165181506,  0.4036233256978761,  0.4084515300606644,  0.4132974646143651,  0.4181602508716810,  0.4230389974488430,  0.4279328006848983,  0.4328407452807588,  0.4377619049571088,  0.4426953431302166,  0.4476401136046476,  0.4525952612818253,  0.4575598228833482,  0.4625328276879220,  0.4675132982807332,  0.4725002513140539,  0.4774926982778309,  0.4824896462789916,  0.4874900988281645,  0.4924930566324989,  0.4974975183932467,  0.5025024816067533,  0.5075069433675011,  0.5125099011718356,  0.5175103537210084,  0.5225073017221691,  0.5274997486859462,  0.5324867017192667,  0.5374671723120781,  0.5424401771166517,  0.5474047387181747,  0.5523598863953525,  0.5573046568697834,  0.5622380950428911,  0.5671592547192411,  0.5720671993151017,  0.5769610025511570,  0.5818397491283190,  0.5867025353856349,  0.5915484699393356,  0.5963766743021239,  0.6011862834818493,  0.6059764465587816,  0.6107463272407405,  0.6154951043954092,  0.6202219725592076,  0.6249261424221701,  0.6296068412883312,  0.6342633135111783,  0.6388948209038036,  0.6435006431234371,  0.6480800780301118,  0.6526324420192693,  0.6571570703281754,  0.6616533173160765,
                                     0.6661205567180796,  0.6705581818728054,  0.6749656059239094,  0.6793422619956299,  0.6836876033425637,  0.6880011034739338,  0.6922822562526472,
                                     0.6965305759695003,  0.7007455973929283,  0.7049268757947342,  0.7090739869522805,  0.7131865271276563,  0.7172641130243737,  0.7213063817221753,  0.7253129905905685,  0.7292836171817254,  0.7332179591034178,  0.7371157338726726,  0.7409766787508575,  0.7448005505609252,  0.7485871254875518,  0.7523361988609284,  0.7560475849249643,  0.7597211165906784,  0.7633566451755506,  0.7669540401296162,  0.7705131887490863,  0.7740339958782712,  0.7775163836005879,  0.7809602909194254,  0.7843656734296323,  0.7877325029803894,  0.7910607673302167,  0.7943504697948491,  0.7976016288887152,  0.8008142779607236,  0.8039884648250596,  0.8071242513876740,  0.8102217132691247,  0.8132809394244244,  0.8163020317605162,  0.8192851047519925,  0.8222302850556398,  0.8251377111243839,  0.8280075328211800,  0.8308399110333725,
                                     0.8336350172880345,  0.8363930333687634,  0.8391141509344001,  0.8417985711401050,  0.8444465042612125,  0.8470581693202558,  0.8496337937175384,  0.8521736128656007,  0.8546778698279148,  0.8571468149621160,  0.8595807055680573,  0.8619798055409597,  0.8643443850298999,  0.8666747201018693,  0.8689710924116107,  0.8712337888774225,  0.8734631013631053,  0.8756593263662033,  0.8778227647126778,  0.8799537212581381,  0.8820525045957266,  0.8841194267707573,  0.8861548030021748,  0.8881589514108994,  0.8901321927551022,  0.8920748501724471,  0.8939872489293182,  0.8958697161770451,  0.8977225807151229,  0.8995461727614166,  0.9013408237293246,  0.9031068660118746,  0.9048446327727060,  0.9065544577438926,  0.9082366750305503,  0.9098916189221609,  0.9115196237105456,  0.9131210235144082,  0.9146961521103655,  0.9162453427703761,  0.9177689281054744,  0.9192672399157112,  0.9207406090461993,  0.9221893652491563,  0.9236138370518396,  0.9250143516302566,  0.9263912346885381,  0.9277448103438598,  0.9290754010167865,  0.9303833273269286,  0.9316689079937786,  0.9329324597426137,  0.9341742972153358,  0.9353947328861257,  0.9365940769817910,  0.9377726374066773,  0.9389307196720247,
                                     0.9400686268296408,  0.9411866594097722,  0.9422851153630460,  0.9433642900063670,  0.9444244759726413,  0.9454659631642163,  0.9464890387099115,  0.9474939869255286,  0.9484810892777210,  0.9494506243511136,  0.9504028678185594,  0.9513380924144211,  0.9522565679107710,  0.9531585610964047,  0.9540443357585604,  0.9549141526672437,  0.9557682695620578,  0.9566069411414400,  0.9574304190542080,  0.9582389518933242,  0.9590327851917829,  0.9598121614205339,  0.9605773199883537,  0.9613284972435761,  0.9620659264776069,  0.9627898379301323,  0.9635004587959488,  0.9641980132333356,  0.9648827223738951,  0.9655548043337889,  0.9662144742263009,  0.9668619441756566,  0.9674974233320340,  0.9681211178877033,  0.9687332310942296,  0.9693339632806829,  0.9699235118727949,  0.9705020714130049,  0.9710698335813457,  0.9716269872171107,  0.9721737183412555,  0.9727102101794846,  0.9732366431859748,  0.9737531950676905,  0.9742600408092490,  0.9747573526982886,  0.9752453003513057,  0.9757240507399157,  0.9761937682175053,  0.9766546145462347,  0.9771067489243624,  0.9775503280138514,  0.9779855059682304,  0.9784124344606795,  0.9788312627123065,  0.9792421375205913,  0.9796452032879694,
                                     0.9800406020505280,  0.9804284735067920,  0.9808089550465746,  0.9811821817798746,  0.9815482865657917,  0.9819074000414489,  0.9822596506508952,
                                     0.9826051646739726,  0.9829440662551345,  0.9832764774321905,  0.9836025181649705,  0.9839223063638881,  0.9842359579183914,  0.9845435867252861,  0.9848453047169222,  0.9851412218892285,  0.9854314463295860,  0.9857160842445291,  0.9859952399872661,  0.9862690160850079,  0.9865375132660970,  0.9868008304869301,  0.9870590649586659,  0.9873123121737100,  0.9875606659319730,  0.9878042183668935,  0.9880430599712218,  0.9882772796225602,  0.9885069646086517,  0.9887322006524178,  0.9889530719367375,  0.9891696611289661,  0.9893820494051910,  0.9895903164742198,  0.9897945406013006,  0.9899947986315702,  0.9901911660132318,  0.9903837168204543,  0.9905725237760017,  0.9907576582735798,  0.9909391903999109,  0.9911171889565268,  0.9912917214812860,  0.9914628542696116,  0.9916306523954509,  0.9917951797319586,  0.9919564989719002,  0.9921146716477800,  0.9922697581516946,  0.9924218177549080,  0.9925709086271556,  0.9927170878556744,  0.9928604114639614,  0.9930009344302630,  0.9931387107057956,  0.9932737932326999,  0.9934062339617291,  0.9935360838696760,  0.9936633929765373,  0.9937882103624203,  0.9939105841841913,  0.9940305616918708,  0.9941481892447742,  0.9942635123274048,
                                     0.9943765755650966,  0.9944874227394127,  0.9945960968033012,  0.9947026398960093,  0.9948070933577597,  0.9949094977441935,  0.9950098928405765,  0.9951083176757783,  0.9952048105360231,  0.9952994089784134,  0.9953921498442354,  0.9954830692720402,  0.9955722027105116,  0.9956595849311175,  0.9957452500405507,  0.9958292314929599,  0.9959115621019767,  0.9959922740525357,  0.9960713989124972,  0.9961489676440697,  0.9962250106150383,  0.9962995576097992,  0.9963726378402058,  0.9964442799562255,  0.9965145120564148,  0.9965833616982082,  0.9966508559080318,  0.9967170211912384,  0.9967818835418671,  0.9968454684522341,  0.9969078009223526,  0.9969689054691864,  0.9970288061357401,  0.9970875264999876,  0.9971450896836414,  0.9972015183607661,  0.9972568347662372,  0.9973110607040478,  0.9973642175554674,  0.9974163262870526,  0.9974674074585143,  0.9975174812304408,  0.9975665673718840,  0.9976146852678044,  0.9976618539263836,  0.9977080919862020,  0.9977534177232854,  0.9977978490580244,  0.9978414035619645,  0.9978840984644739,  0.9979259506592871,  0.9979669767109295,  0.9980071928610224,  0.9980466150344718,  0.9980852588455432,  0.9981231396038235,  0.9981602723200724,
                                     0.9981966717119649,  0.9982323522097281,  0.9982673279616705,  0.9983016128396112,  0.9983352204442056,  0.9983681641101733,  0.9984004569114251,
                                     0.9984321116660980,  0.9984631409414920,  0.9984935570589170,  0.9985233720984465,  0.9985525979035829,  0.9985812460858343,  0.9986093280292057,  0.9986368548946046,  0.9986638376241639,  0.9986902869454819,  0.9987162133757840,  0.9987416272260028,  0.9987665386047840,  0.9987909574224130,  0.9988148933946682,  0.9988383560466032,  0.9988613547162515,  0.9988838985582669,  0.9989059965474898,  0.9989276574824478,  0.9989488899887889,  0.9989697025226476,  0.9989901033739494,  0.9990101006696500,  0.9990297023769125,  0.9990489163062243,  0.9990677501144545,  0.9990862113078519,  0.9991043072449847,  0.9991220451396260,  0.9991394320635814,  0.9991564749494637,  0.9991731805934126,  0.9991895556577647,  0.9992056066736690,  0.9992213400436532,  0.9992367620441412,  0.9992518788279210,  0.9992666964265652,  0.9992812207528043,  0.9992954576028552,  0.9993094126587031,  0.9993230914903409,  0.9993364995579636,  0.9993496422141214,  0.9993625247058298,  0.9993751521766405,  0.9993875296686711,  0.9993996621245944,  0.9994115543895908,  0.9994232112132622,  0.9994346372515082,  0.9994458370683663,  0.9994568151378161,  0.9994675758455485,  0.9994781234907002,  0.9994884622875549,
                                     0.9994985963672109,  0.9995085297792168,  0.9995182664931734,  0.9995278104003081,  0.9995371653150147,  0.9995463349763648,  0.9995553230495905,  0.9995641331275369,  0.9995727687320864,  0.9995812333155556,  0.9995895302620650,  0.9995976628888812,  0.9996056344477331,  0.9996134481261033,  0.9996211070484928,  0.9996286142776619,  0.9996359728158466,  0.9996431856059506,  0.9996502555327149,  0.9996571854238643,  0.9996639780512302,  0.9996706361318534,  0.9996771623290641,  0.9996835592535397,  0.9996898294643448,  0.9996959754699479,  0.9997019997292195,  0.9997079046524101,  0.9997136926021100,  0.9997193658941886,  0.9997249267987179,  0.9997303775408740,  0.9997357203018240,  0.9997409572195950,  0.9997460903899255,  0.9997511218670986,  0.9997560536647627,  0.9997608877567320,  0.9997656260777736,  0.9997702705243778,  0.9997748229555155,  0.9997792851933770,  0.9997836590241006,  0.9997879461984827,  0.9997921484326772,  0.9997962674088793,  0.9998003047759964,  0.9998042621503057,  0.9998081411160992,  0.9998119432263149,  0.9998156700031575,  0.9998193229387050,  0.9998229034955035,  0.9998264131071526,  0.9998298531788757,  0.9998332250880823,  0.9998365301849164,
                                     0.9998397697927968,  0.9998429452089446,  0.9998460577049015,  0.9998491085270375,  0.9998520988970482,  0.9998550300124434,  0.9998579030470244,  0.9998607191513537,  0.9998634794532143,  0.9998661850580602,  0.9998688370494577,  0.9998714364895183,  0.9998739844193243,  0.9998764818593425,  0.9998789298098345,  0.9998813292512542,  0.9998836811446415,  0.9998859864320044,  0.9998882460366977,  0.9998904608637904,  0.9998926318004279,  0.9998947597161872,  0.9998968454634241,  0.9998988898776137,  0.9999008937776848,  0.9999028579663474,  0.9999047832304137,  0.9999066703411118,  0.9999085200543958,  0.9999103331112464,  0.9999121102379687,  0.9999138521464810,  0.9999155595346013,  0.9999172330863259,  0.9999188734721015,  0.9999204813490958,  0.9999220573614588,  0.9999236021405808,  0.9999251163053449,  0.9999266004623749,  0.9999280552062784,  0.9999294811198833,  0.9999308787744726,  0.9999322487300116,  0.9999335915353734,  0.9999349077285569,  0.9999361978369037,  0.9999374623773080,  0.9999387018564240,  0.9999399167708684,  0.9999411076074189,  0.9999422748432104,  0.9999434189459243,  0.9999445403739758,  0.9999456395766992,  0.9999467169945253,  0.9999477730591597,
                                     0.9999488081937546,  0.9999498228130782,  0.9999508173236810,  0.9999517921240584,  0.9999527476048107,  0.9999536841487987,  0.9999546021312976, };
        static const T sig_k = 20. / 1000.;
        static const int sig_max_idx = 999;

        v = v + 10.;
        v = 20. < v ? 20. : 0. > v ? 0. : v;
        int idx = int(v / sig_k);
        idx = sig_max_idx < idx ? sig_max_idx : idx;

        return sig_tab[idx];
    }

}

}

#endif
